name: Test smart contracts

on:
  push:
    branches: ["main"]

env:
  MUMBAI_PROVIDER: ${{ secrets.MUMBAI_PROVIDER }}
  GOERLI_PROVIDER: ${{ secrets.GOERLI_PROVIDER }}
  POLYGON_PROVIDER: ${{ secrets.POLYGON_PROVIDER }}
  FRAK_DEPLOY_PRIV_KEY: ${{ secrets.SYBEL_DEPLOY_PRIVATE_KEY }}
  POLYGON_SCAN_API_KEY: ${{ secrets.POLYGONSCAN_API_KEY }}
  ETHER_SCAN_API_KEY: ${{ secrets.ETHER_SCAN_API_KEY }}
  COIN_MARKET_CAP_API_KEY: ${{ secrets.COIN_MARKET_CAP_API_KEY }}

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3
    
      - name: Install Foundry
        uses: foundry-rs/foundry-toolchain@v1

      - name: Run tests
        run: forge test -vvv

      - name: Run snapshot
        run: forge snapshot
